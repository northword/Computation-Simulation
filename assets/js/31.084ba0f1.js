(window.webpackJsonp=window.webpackJsonp||[]).push([[31],{456:function(s,t,a){"use strict";a.r(t);var n=a(4),e=Object(n.a)({},(function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"使用pbs管理作业的几种命令"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#使用pbs管理作业的几种命令"}},[s._v("#")]),s._v(" 使用PBS管理作业的几种命令")]),s._v(" "),a("h2",{attrs:{id:"提交作业"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#提交作业"}},[s._v("#")]),s._v(" 提交作业")]),s._v(" "),a("p",[s._v("用以下命令提交作业：")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("$ qsub "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("options"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("control script"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("命令执行后会返回一个作业ID。如：")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("zjb@op back"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("$ qsub -N thisIsName vasp.pbs \n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("201848")]),s._v(".inode202\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("p",[s._v("作业提交后一般会先排队等待，PBS 系统会根据作业的优先级和可用的计算资源来调度和执行作业。")]),s._v(" "),a("p",[s._v("其中"),a("code",[s._v("-N thisIsName")]),s._v("为选项，它指定了作业的名称。"),a("code",[s._v("vasp.pbs")]),s._v("为PBS脚本，它设定了作业的属性和作业的内容。"),a("code",[s._v("options")]),s._v("与"),a("code",[s._v("control script")]),s._v("详见 "),a("RouterLink",{attrs:{to:"/03.Linux/02.pbs/PBS-script.html"}},[a("code",[s._v("## PBS脚本")])]),s._v("。")],1),s._v(" "),a("blockquote",[a("p",[s._v("文档中，命令带有"),a("code",[s._v("$")]),s._v("符号的，表示是在shell终端输入的命令，实际输入的时候不需要带有这个符号。")])]),s._v(" "),a("h2",{attrs:{id:"查看任务"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#查看任务"}},[s._v("#")]),s._v(" 查看任务")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("$ qstat "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("option"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("jobid"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("如：")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("zjb@op back"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("$ qstat\nJob ID                    Name             User            Time Use S Queue\n------------------------- ---------------- --------------- -------- - -----\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("201848")]),s._v(".inode202            thisIsName       zjb             00:00:00 C energy         \n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("p",[s._v("其中，"),a("code",[s._v("S")]),s._v("表示任务的状态，有如下几种状态：")]),s._v(" "),a("table",[a("thead",[a("tr",[a("th",[s._v("状态(S)")]),s._v(" "),a("th",[s._v("描述")])])]),s._v(" "),a("tbody",[a("tr",[a("td",[s._v("B")]),s._v(" "),a("td",[s._v("只用于任务向量，表示任务向量已经开始执行")])]),s._v(" "),a("tr",[a("td",[s._v("E")]),s._v(" "),a("td",[s._v("任务在运行后退出")])]),s._v(" "),a("tr",[a("td",[s._v("H")]),s._v(" "),a("td",[s._v("任务被服务器或用户或者管理员阻塞")])]),s._v(" "),a("tr",[a("td",[a("strong",[s._v("Q")])]),s._v(" "),a("td",[a("strong",[s._v("任务正在排队中，等待被调度运行")])])]),s._v(" "),a("tr",[a("td",[a("strong",[s._v("R")])]),s._v(" "),a("td",[a("strong",[s._v("任务正在运行")])])]),s._v(" "),a("tr",[a("td",[a("strong",[s._v("C")])]),s._v(" "),a("td",[a("strong",[s._v("任务完成")])])]),s._v(" "),a("tr",[a("td",[s._v("S")]),s._v(" "),a("td",[s._v("任务被服务器挂起，由于一个更高优先级的任务需要当前任务的资源")])]),s._v(" "),a("tr",[a("td",[s._v("T")]),s._v(" "),a("td",[s._v("任务被转移到其它执行节点了")])]),s._v(" "),a("tr",[a("td",[s._v("U")]),s._v(" "),a("td",[s._v("由于服务器繁忙，任务被挂起")])]),s._v(" "),a("tr",[a("td",[s._v("W")]),s._v(" "),a("td",[s._v("任务在等待它所请求的执行时间的到来(qsub -a)")])]),s._v(" "),a("tr",[a("td",[s._v("X")]),s._v(" "),a("td",[s._v("只用于子任务，表示子任务完成")])])])]),s._v(" "),a("h3",{attrs:{id:"qstat-的选项"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#qstat-的选项"}},[s._v("#")]),s._v(" qstat 的选项")]),s._v(" "),a("table",[a("thead",[a("tr",[a("th",[s._v("命令")]),s._v(" "),a("th",[s._v("说明")])])]),s._v(" "),a("tbody",[a("tr",[a("td",[s._v("qstat -q")]),s._v(" "),a("td",[s._v("列出所有队列")])]),s._v(" "),a("tr",[a("td",[s._v("qstat -a")]),s._v(" "),a("td",[s._v("列出所有作业")])]),s._v(" "),a("tr",[a("td",[s._v("qstat -u user_id")]),s._v(" "),a("td",[s._v("列出user_id的所有作业")])]),s._v(" "),a("tr",[a("td",[s._v("qstat -r")]),s._v(" "),a("td",[s._v("列出所有正在运行的作业")])]),s._v(" "),a("tr",[a("td",[s._v("qstat -f job_id")]),s._v(" "),a("td",[s._v("列出作业job_id的信息")])]),s._v(" "),a("tr",[a("td",[s._v("qstat -fQ queue")]),s._v(" "),a("td",[s._v("列出队列queue的信息")])]),s._v(" "),a("tr",[a("td",[s._v("qstat -B")]),s._v(" "),a("td",[s._v("列出所有作业状态的汇总")])]),s._v(" "),a("tr",[a("td",[s._v("pbsnodes")]),s._v(" "),a("td",[s._v("列出所有节点的详细信息")])]),s._v(" "),a("tr",[a("td",[s._v("pestat")]),s._v(" "),a("td",[s._v("列出所有节点的状态")])])])]),s._v(" "),a("h2",{attrs:{id:"取消任务"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#取消任务"}},[s._v("#")]),s._v(" 取消任务")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("$ qdel "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("jobid"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h2",{attrs:{id:"停止正在运行的任务"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#停止正在运行的任务"}},[s._v("#")]),s._v(" 停止正在运行的任务")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("$ qsig -s KILL "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("job ID"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h2",{attrs:{id:"checkjob"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#checkjob"}},[s._v("#")]),s._v(" checkjob")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("$ checkjob "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("job id"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("注意这儿的"),a("code",[s._v("job id")]),s._v("不包括"),a("code",[s._v(".inodexxx")]),s._v("，比如上述的"),a("code",[s._v("201848.inode202")]),s._v("作业，如果使用"),a("code",[s._v("checkjob")]),s._v("查询，命令应为"),a("code",[s._v("checkjob 201848")]),s._v("。")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("zjb@op testEnergy"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("$ checkjob "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("201848")]),s._v("\n\n\nchecking job "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("201848")]),s._v("\n\nState: Running\nCreds:  user:zjb  group:energy  account:SugonClus  class:energy  qos:preemptee\nWallTime: 00:02:03 of 00:30:00\nSubmitTime: Sat Oct "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("31")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("19")]),s._v(":45:48\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("Time Queued  Total: 00:00:01  Eligible: 00:00:01"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\nStartTime: Sat Oct "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("31")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("19")]),s._v(":45:49\nTotal Tasks: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v("\n\nReq"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("  TaskCount: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v("  Partition: DEFAULT\nNetwork: "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("NONE"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("  Memory "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  Disk "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  Swap "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\nOpsys: "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("NONE"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("  Arch: "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("NONE"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("  Features: "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("NONE"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\nAllocated Nodes:\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("inode53:4"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n\n\nIWD: "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("NONE"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("  Executable:  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("NONE"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\nBypass: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  StartCount: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\nPartitionMask: "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("ALL"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\nFlags:       BACKFILL RESTARTABLE PREEMPTEE\nAttr:        PREEMPTEE\n\nReservation "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'201868'")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("-00:02:04 -"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" 00:27:56  Duration: 00:30:00"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nPE:  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4.00")]),s._v("  StartPriority:  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("6000")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br")])]),a("p",[s._v("如果任务无法运行，可以这样查询原因。")]),s._v(" "),a("h2",{attrs:{id:"pbsnodes"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#pbsnodes"}},[s._v("#")]),s._v(" pbsnodes")]),s._v(" "),a("p",[s._v("查看节点的空闲情况。有"),a("code",[s._v("free")]),s._v("、"),a("code",[s._v("busy")]),s._v("、"),a("code",[s._v("down")]),s._v("等状态。")])])}),[],!1,null,null,null);t.default=e.exports}}]);