(window.webpackJsonp=window.webpackJsonp||[]).push([[32],{457:function(s,t,a){"use strict";a.r(t);var n=a(4),e=Object(n.a)({},(function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"pbs脚本"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#pbs脚本"}},[s._v("#")]),s._v(" PBS脚本")]),s._v(" "),a("p",[s._v("PBS脚本实际上是一个linux shell脚本，在 PBS 脚本中可以用一种特殊形式的注释（#PBS）作为 PBS 指令以设定作业属性。下面是一个 PBS 脚本示例：")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token shebang important"}},[s._v("#!/bin/sh")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#PBS -N Untitled")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#PBS -l nodes=1:ppn=4")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#PBS -l walltime=00:10:00")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#PBS -j oe")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#PBS -o ./out.log")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${PBS_O_WORKDIR}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("source")]),s._v(" /public/software/profile.d/compiler_intel-composer_xe_2015.2.164.sh\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("source")]),s._v(" /public/software/profile.d/mpi_intelmpi-5.0.2.044.sh\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"============================================="')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Starting VASP run at"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("date")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")])]),s._v(" \n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"============================================="')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"# SYSTEM INFO"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'The hostname is '")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("hostname")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")])]),s._v("  \n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'Linux'")]),s._v(" /etc/issue \n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'model name'")]),s._v(" /proc/cpuinfo "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("cut")]),s._v(" -d: -f2 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("uniq")]),s._v(" -c\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'cpu M'")]),s._v(" /proc/cpuinfo \n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'MemTotal'")]),s._v(" /proc/meminfo\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"============================================="')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"# PBS INFO"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"The PBS_O_WORKDIR is"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$PBS_O_WORKDIR")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"The PBS_JOBID is"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$PBS_JOBID")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"The PBS_O_QUEUE is"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$PBS_O_QUEUE")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"The PBS_O_HOST is"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$PBS_O_HOST")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("NP")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token variable"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("cat")]),s._v(" $PBS_NODEFILE "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("wc")]),s._v(" -l"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")])]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"The num of PBS_NODEFILE is"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$NP")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"The PBS_NODEFILE IS:"')]),s._v(" \n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("cat")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$PBS_NODEFILE")]),s._v("\nmpirun -np "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$NP")]),s._v(" -machinefile "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$PBS_NODEFILE")]),s._v(" /public/software//apps/vasp/5.4.1/intelmpi/vasp_std "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">&")]),s._v(" stdout\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"============================================="')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"End task at "')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("date")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")])]),s._v("  \n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"============================================="')]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br")])]),a("h2",{attrs:{id:"pbs作业属性"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#pbs作业属性"}},[s._v("#")]),s._v(" PBS作业属性")]),s._v(" "),a("table",[a("thead",[a("tr",[a("th",[s._v("属性")]),s._v(" "),a("th",[s._v("取值")]),s._v(" "),a("th",[s._v("说明")])])]),s._v(" "),a("tbody",[a("tr",[a("td",[s._v("-l")]),s._v(" "),a("td",[s._v("资源列表")]),s._v(" "),a("td",[s._v("设定作业所需资源，以逗号分隔")])]),s._v(" "),a("tr",[a("td",[s._v("-N")]),s._v(" "),a("td",[s._v("作业名称")]),s._v(" "),a("td",[s._v("设定作业的默认名称")])]),s._v(" "),a("tr",[a("td",[s._v("-o")]),s._v(" "),a("td",[s._v("文件路径")]),s._v(" "),a("td",[s._v("设定作业的标准输出文件路径")])]),s._v(" "),a("tr",[a("td",[s._v("-e")]),s._v(" "),a("td",[s._v("文件路径")]),s._v(" "),a("td",[s._v("设定作业的标准错误文件路径")])]),s._v(" "),a("tr",[a("td",[s._v("-j")]),s._v(" "),a("td",[s._v("oe或eo")]),s._v(" "),a("td",[s._v("oe:将标准错误文件与标准输出文件合并成标准输出文件。eo:将标准错误文件和标准输出文件合并成标准错误文件")])]),s._v(" "),a("tr",[a("td",[s._v("-p")]),s._v(" "),a("td",[s._v("-1024 到 +1023 之间的整数")]),s._v(" "),a("td",[s._v("设定作业优先级，越大优先级越高")])]),s._v(" "),a("tr",[a("td",[s._v("-q")]),s._v(" "),a("td",[s._v("队列名称")]),s._v(" "),a("td",[s._v("设定作业队列名称")])])])]),s._v(" "),a("h2",{attrs:{id:"资源列表"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#资源列表"}},[s._v("#")]),s._v(" 资源列表")]),s._v(" "),a("table",[a("thead",[a("tr",[a("th",[s._v("资源")]),s._v(" "),a("th",[s._v("取值")]),s._v(" "),a("th",[s._v("说明")])])]),s._v(" "),a("tbody",[a("tr",[a("td",[s._v("nodes")]),s._v(" "),a("td",[s._v("节点资源构型")]),s._v(" "),a("td",[s._v("设定作业所需计算节点资源")])]),s._v(" "),a("tr",[a("td",[s._v("walltime")]),s._v(" "),a("td",[s._v("hh:mm:ss")]),s._v(" "),a("td",[s._v("设定作业所需的最大 wallclock 时间")])]),s._v(" "),a("tr",[a("td",[s._v("cput")]),s._v(" "),a("td",[s._v("hh:mm:ss")]),s._v(" "),a("td",[s._v("设定作业所需的最大 CPU 时间")])]),s._v(" "),a("tr",[a("td",[s._v("mem")]),s._v(" "),a("td",[s._v("正整数，后面可跟 b，kb，mb，gb")]),s._v(" "),a("td",[s._v("设定作业所需的最大内存  ncpus 正整数 设定作业所需的 CPU 数目")])])])]),s._v(" "),a("h2",{attrs:{id:"pbs常用环境变量"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#pbs常用环境变量"}},[s._v("#")]),s._v(" PBS常用环境变量")]),s._v(" "),a("table",[a("thead",[a("tr",[a("th",[s._v("环境变量")]),s._v(" "),a("th",[s._v("说明")])])]),s._v(" "),a("tbody",[a("tr",[a("td",[s._v("PBS_ENVIRONMENT")]),s._v(" "),a("td",[s._v("批处理作业为 PBS_BATCH，交互式作业为 PBS_INTERACTIVE")])]),s._v(" "),a("tr",[a("td",[s._v("PBS_JOBID PBS")]),s._v(" "),a("td",[s._v("系统给作业分配的标识号")])]),s._v(" "),a("tr",[a("td",[s._v("PBS_JOBNAME")]),s._v(" "),a("td",[s._v("用户指定的作业名称")])]),s._v(" "),a("tr",[a("td",[s._v("PBS_NODEFILE")]),s._v(" "),a("td",[s._v("包含作业所用计算节点的文件名")])]),s._v(" "),a("tr",[a("td",[s._v("PBS_QUEUE")]),s._v(" "),a("td",[s._v("作业所执行的队列名称")])]),s._v(" "),a("tr",[a("td",[s._v("PBS_O_HOME")]),s._v(" "),a("td",[s._v("执行 qsub 命令的 HOME 环境变量值")])]),s._v(" "),a("tr",[a("td",[s._v("PBS_O_PATH")]),s._v(" "),a("td",[s._v("执行 qsub 命令的 PATH 环境变量值")])]),s._v(" "),a("tr",[a("td",[s._v("PBS_O_SHELL")]),s._v(" "),a("td",[s._v("执行 qsub 命令的 SHELL 环境变量值")])]),s._v(" "),a("tr",[a("td",[s._v("PBS_O_HOST")]),s._v(" "),a("td",[s._v("执行 qsub 命令节点名称")])]),s._v(" "),a("tr",[a("td",[s._v("PBS_O_QUEUE")]),s._v(" "),a("td",[s._v("提交的作业的最初队列名称")])]),s._v(" "),a("tr",[a("td",[s._v("PBS_O_WORKDIR")]),s._v(" "),a("td",[s._v("执行 qsub 命令所在的绝对路径")])])])])])}),[],!1,null,null,null);t.default=e.exports}}]);